WITH jore3_route AS (
    -- This route geometry data is copyright Â© by 2021 Helsingin seudun liikenne (HSL) and licensed under a Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/).
    SELECT ST_GeomFromEWKT('SRID=4326;LINESTRING(24.845243252 60.314435059,24.845029171 60.314553103,24.844566907 60.31487019,24.847936403 60.316419499,24.84674025 60.317046444,24.846061087 60.317373892,24.84441763 60.318201126,24.844132538 60.318373474,24.84395554 60.318527184,24.843760679 60.318689983,24.843654432 60.318780414,24.843566046 60.318861756,24.842732291 60.319513292,24.842502616 60.319730164,24.842134421 60.320190257,24.842030937 60.320388377,24.842014459 60.320451312,24.841966411 60.32069396,24.841949009 60.320720997,24.841933917 60.320837777,24.84178007 60.321188803,24.841587259 60.321432367,24.84128726 60.321730462,24.841148036 60.32194676,24.841030366 60.322297556,24.840978848 60.32240559,24.840874658 60.322576787,24.841128919 60.322611082,24.841219859 60.322628459,24.841383874 60.3226723,24.841492909 60.322689561,24.841583619 60.322697963,24.841819324 60.322714423,24.842000281 60.322713278,24.842216968 60.322693955,24.842541765 60.322655995,24.842740586 60.32264576,24.842921543 60.322644613,24.843066539 60.32265267,24.843611723 60.32273897,24.844102622 60.322825613,24.844632264 60.323010741,24.845288816 60.323204036,24.84603307 60.323289061,24.846886137 60.323382365,24.847340398 60.323451278,24.847722741 60.323538599,24.84816077 60.323679418,24.848562844 60.323829441,24.849077692 60.324140305,24.849244287 60.324282853,24.8493371 60.324372017,24.849467272 60.324505822,24.849542688 60.324622024,24.849655697 60.324791841,24.849714183 60.32495303,24.849736943 60.325132399,24.849744169 60.325410599,24.849714735 60.325671083,24.849690662 60.326137973,24.849679325 60.326398341,24.849672417 60.326829219,24.849712809 60.326990523,24.849751103 60.32707106,24.849826993 60.327205211,24.849920282 60.327312323,24.85003167 60.32741932,24.85023495 60.327579584,24.85049276 60.327748474,24.850824835 60.327988694,24.851728257 60.328620188,24.852152247 60.328913671,24.852318881 60.329056215,24.852598322 60.329359598,24.852767768 60.329609832,24.853398204 60.329489105,24.853776417 60.329414873,24.854226088 60.329304278,24.854567395 60.329203353,24.855033048 60.329011871,24.856196569 60.328510724,24.85677056 60.328309563,24.857004433 60.328254202,24.857257344 60.328234621,24.857655044 60.328214106,24.858180376 60.32822867,24.858362305 60.328263399,24.85868973 60.328324116,24.859182403 60.328473522,24.86078974 60.329019625,24.861648199 60.329310266,24.862195672 60.329477258,24.862541926 60.329564771,24.862796975 60.329625947,24.862832226 60.329589815,24.862993463 60.329525939,24.863174694 60.329533739,24.863299731 60.329470098,24.864104717 60.329105843,24.864354784 60.328978558,24.864692972 60.328760943,24.864870164 60.32861618,24.864975672 60.32849881,24.865099278 60.328381322,24.865186686 60.328264069,24.865273618 60.328128868,24.865566332 60.327561493,24.865705655 60.327354145,24.865774959 60.32723701,24.866003344 60.326975227,24.866391039 60.326577771,24.866602743 60.32636995,24.867237364 60.325728538,24.867694561 60.325222916,24.867870055 60.325015329,24.868169127 60.324690252,24.86850248 60.324293143,24.868678439 60.324103504,24.868783681 60.323977157,24.868906064 60.323814794,24.86900892 60.323598705,24.869059155 60.323445789,24.869053433 60.323230409,24.86895032 60.322755369,24.868926504 60.322540107,24.868922214 60.322378572,24.868954591 60.322234748,24.868985775 60.322046054,24.869053865 60.321884046,24.869587621 60.320857324,24.869724266 60.320551256,24.869876855 60.320164301,24.86995802 60.319813717,24.87000395 60.319499266,24.869977743 60.319194262,24.869937261 60.319032964,24.869917259 60.318961289,24.869783925 60.31871084,24.869597506 60.318505617,24.869558219 60.318389189,24.869391088 60.318228718,24.869187058 60.318041562,24.869075878 60.317943555,24.8690016 60.317872234,24.868945176 60.317791821,24.868888753 60.317711408,24.8688309 60.31757715,24.868809234 60.317442656,24.868805421 60.317299069,24.868991332 60.316804189,24.869058219 60.31659731,24.868659953 60.316590936,24.868225026 60.316566848,24.867591562 60.316562007,24.86713902 60.316555982,24.8668674 60.316548777,24.866197752 60.316544164,24.865763065 60.316529043,24.865382655 60.316513568,24.865001771 60.316480142,24.864638032 60.316410702,24.864310478 60.316341025,24.863399008 60.316086649,24.858953715 60.314939612,24.858461954 60.314817127,24.857951635 60.314676809,24.857550337 60.314553737,24.857185224 60.31443043,24.856362203 60.314094655,24.855830528 60.313828806,24.8555728 60.313659925,24.855258224 60.313392677,24.855012732 60.312999323,24.85486215 60.312775898,24.854495661 60.312598739,24.854255571 60.312411791,24.854069988 60.312233469,24.853218204 60.311484975,24.854350341 60.311190483,24.854438913 60.311118108,24.854418716 60.311037457,24.853680168 60.310467753,24.852570993 60.309559345,24.852108738 60.309176351,24.851754088 60.308756764,24.851531197 60.308533798,24.851079823 60.307872484,24.850947612 60.307657913,24.849855212 60.305995413,24.84945933 60.305378617,24.849384658 60.305289337,24.849073471 60.305147713,24.848529962 60.305115279,24.846739223 60.305117719,24.846751042 60.304875299,24.846999576 60.303994095,24.847498496 60.303003585,24.848283712 60.301894563,24.84861824 60.301542374,24.849059401 60.301117698,24.849222853 60.301143582,24.849386538 60.301178439,24.849732924 60.301283935,24.849952725 60.301390238,24.850173926 60.301550387,24.850230741 60.301648757,24.846563643 60.302524851,24.846167175 60.302581229,24.845842349 60.302610223,24.84540832 60.302612984,24.845064018 60.302588245,24.844755423 60.302545328,24.844392344 60.30249378,24.842340483 60.302183668,24.84114 60.301921997,24.840142836 60.301829568,24.838947672 60.301774285,24.838423692 60.301795541,24.838027908 60.301878818,24.837238169 60.302117162,24.836339684 60.30234721,24.83583309 60.30234142,24.834096067 60.302316425,24.833339261 60.302428879,24.829816755 60.303321553,24.831415611 60.302889707,24.833357345 60.302428765,24.834114151 60.302316311,24.835561594 60.30233415,24.836357768 60.302347096,24.837220085 60.302117276,24.838045762 60.30186973,24.838441546 60.301786453,24.838947902 60.301783259,24.840215172 60.301829111,24.841158084 60.301921882,24.842358567 60.302183554,24.844483229 60.302511154,24.845082103 60.30258813,24.845462342 60.302603665,24.845751926 60.302610799,24.846167175 60.302581229,24.846563643 60.302524851,24.850230741 60.301648757,24.850878267 60.301509979,24.851689709 60.301415026,24.852359746 60.301446635,24.85255937 60.301472283,24.853068057 60.301558777,24.853340954 60.301619856,24.853887217 60.301759961,24.854742321 60.301951933,24.855394992 60.302010566,24.856025592 60.30191675,24.856420861 60.301815471,24.8568685 60.301642048,24.857026793 60.301470488,24.857291237 60.301208487,24.857467374 60.301027836,24.857699405 60.300909655,24.859548112 60.300368147,24.859323577 60.300082374,24.858971288 60.299752548,24.858711773 60.299511879,24.858133803 60.298851405,24.857820055 60.298611085,24.857598602 60.298441974,24.857209949 60.298103402,24.856838916 60.297746764,24.856672189 60.297595251,24.856340616 60.297364018,24.856661625 60.29719141,24.857176593 60.296829061,24.857353647 60.296684307,24.857441704 60.296593982,24.857511209 60.296485824,24.857037577 60.296354242,24.856254461 60.29614387,24.854049114 60.295484875,24.853448246 60.295327171,24.853048371 60.295248955,24.852612337 60.295170971,24.852340197 60.295136813,24.851597033 60.29506977,24.85107177 60.29503723,24.850637608 60.295031033,24.850601681 60.295040239,24.850185833 60.295042899,24.849842772 60.295063044,24.848110076 60.295190794,24.84727884 60.295214046,24.846374353 60.295201856,24.845958038 60.295186554,24.8455051 60.295153533,24.844725095 60.295059758,24.843581638 60.29489648,24.842711013 60.294794293,24.842183685 60.29468095,24.841981804 60.294565544,24.841778309 60.294387318,24.841628365 60.294181826,24.841550973 60.29398485,24.841527359 60.293769581,24.841612454 60.293562601,24.841752709 60.293391174,24.841874191 60.293192938,24.84248781 60.292444064,24.842556894 60.292317966,24.843517261 60.290992442,24.843867727 60.290559382,24.844095802 60.290288661,24.844431183 60.28997238,24.84457349 60.289881718,24.845250711 60.289500432,24.845518859 60.289382042,24.846235922 60.28914411,24.847148572 60.288779266,24.849078782 60.287914254,24.849506333 60.287669177,24.850800499 60.286682542,24.851917102 60.285822693,24.85087679 60.285443399,24.850347723 60.285258294,24.849655754 60.285065253,24.84999033 60.284722035,24.850607101 60.284107737,24.850871457 60.283845748,24.851346869 60.283358012,24.851980496 60.282698721,24.852422062 60.282300956,24.853041078 60.28177639,24.853323937 60.281532229,24.853746931 60.281116627,24.854291743 60.280520725,24.854396901 60.280394388,24.854571071 60.280141947,24.854691959 60.279925751,24.854759565 60.279745801,24.854845243 60.279565734,24.854891499 60.279260261,24.854884476 60.278991033,24.854843417 60.278802805,24.854739018 60.278264931,24.854620763 60.277888709,24.854483972 60.277494654,24.853888575 60.277534384,24.853564472 60.277581345,24.853312183 60.277609893,24.853235928 60.277457794,24.853033181 60.277306508)') AS geom
),
via_points AS (
    -- Predefined points through which the matched route must pass. These are mapped to nearest topology vertices while finding path.
    SELECT ARRAY[ ST_GeomFromEWKT('SRID=4326;POINT(24.829816755 60.303321553)') ] AS geom_arr
    -- SELECT ARRAY[]::geometry[] AS geom_arr  -- test empty array
),
match_params AS (
    SELECT
        -- Digiroad stops on both ends of Jore3 route are searched within this given radius (in meters).
        40 AS route_endpoint_search_radius,
        -- Digiroad link endpoints (vertices in topology) are searched for each via point within this given radius (in meters).
        20 AS via_point_search_radius,
        -- The radius (in meters) used to expand Jore3 route to filter applicable Digiroad links.
        100 AS route_expand_radius
),
jore3_route_3067 AS (
    SELECT ST_Transform(geom, 3067) AS geom FROM jore3_route
),
route_endpoints AS (
    SELECT 'start' AS endpoint_type, ST_StartPoint(geom) AS geom FROM jore3_route_3067
    UNION
    SELECT 'end', ST_EndPoint(geom) FROM jore3_route_3067
),
route_terminal_info AS (
    -- Find terminal links on both route endpoints by first resolving closest Digiroad stop and then get links.
    SELECT
        rep.endpoint_type,
        closest_dr_stop.stop_gid,
        closest_dr_stop.dist,
        link.gid AS link_gid,
        link.link_id
    FROM route_endpoints rep, match_params p
    CROSS JOIN LATERAL (
        SELECT
            dr_stop.gid AS stop_gid, 
            rep.geom <-> dr_stop.geom AS dist
        FROM routing.dr_pysakki dr_stop
        WHERE ST_DWithin(rep.geom, dr_stop.geom, p.route_endpoint_search_radius)
        ORDER BY rep.geom <-> dr_stop.geom
        LIMIT 1
    ) AS closest_dr_stop
    INNER JOIN routing.dr_pysakki stop ON stop.gid = closest_dr_stop.stop_gid
    INNER JOIN routing.dr_linkki_k link ON link.gid = stop.link_gid
),
ordered_via_point_set AS (
    SELECT (dp).path, (dp).geom
    FROM (
        SELECT ST_Dump(ST_Transform(ST_Collect(geom_arr), 3067)) AS dp
        FROM (
            -- Filter out empty via point array.
            SELECT geom_arr FROM via_points WHERE cardinality(geom_arr) > 0
        ) y
    ) x
    ORDER BY path
),
via_point_closest_vertices AS (
    -- Find closest vertex for each via point.
    SELECT
        vp.path,
        closest_vertex.vertex_id,
        closest_vertex.dist
    FROM ordered_via_point_set vp, match_params p
    CROSS JOIN LATERAL (
        SELECT
            vert.id AS vertex_id, 
            vp.geom <-> vert.the_geom AS dist
        FROM routing.dr_linkki_k_vertices_pgr vert
        WHERE ST_DWithin(vp.geom, vert.the_geom, p.via_point_search_radius)
        ORDER BY vp.geom <-> vert.the_geom
        LIMIT 1
    ) AS closest_vertex
    INNER JOIN routing.dr_linkki_k_vertices_pgr vert ON vert.id = closest_vertex.vertex_id
    ORDER BY vp.path
),
via_vertices AS (
    -- XXX: Note the array cast (int vs bigint). Beware!
    SELECT array_agg(vertex_id)::int[] AS id_arr FROM via_point_closest_vertices
),
edge_query AS (
    -- Construct edge query for pgr_dijkstra function.
    SELECT query.txt
    FROM (
        SELECT array_to_string(array_agg(link_gid), ',') AS txt
        FROM route_terminal_info
    ) terminal_link_gids, match_params p
    CROSS JOIN LATERAL (
        -- Filtering edges in WHERE clause.
        SELECT 'SELECT gid AS id, source, target, cost, reverse_cost'
            || ' FROM routing.dr_linkki_k'
            || ' WHERE gid IN (' || terminal_link_gids.txt || ')'
            || ' OR ST_Contains(ST_Buffer(ST_Transform(ST_GeomFromEWKT(''' || ST_AsEWKT(geom) || '''), 3067), ' || p.route_expand_radius || '), geom)' AS txt
        FROM jore3_route
    ) query
),
shortest_path_alternatives AS (
    SELECT paths.*
    FROM edge_query query, via_vertices via
    CROSS JOIN (
        -- Produce 2 start points for both endpoints of the first link.
        SELECT source AS vertex_id
        FROM route_terminal_info rti
        INNER JOIN routing.dr_linkki_k l ON l.gid = rti.link_gid
        WHERE rti.endpoint_type = 'start'
        UNION
        SELECT target
        FROM route_terminal_info rti
        INNER JOIN routing.dr_linkki_k l ON l.gid = rti.link_gid
        WHERE rti.endpoint_type = 'start'
    ) AS start_vertices
    CROSS JOIN (
        -- Produce 2 end points for both endpoints of the last link.
        SELECT source AS vertex_id
        FROM route_terminal_info rti
        INNER JOIN routing.dr_linkki_k l ON l.gid = rti.link_gid
        WHERE rti.endpoint_type = 'end'
        UNION
        SELECT target
        FROM route_terminal_info rti
        INNER JOIN routing.dr_linkki_k l ON l.gid = rti.link_gid
        WHERE rti.endpoint_type = 'end'
    ) AS end_vertices
    CROSS JOIN LATERAL (
        -- Produce 4 path alternatives by 4 permutations on 2 different endpoints on both ends of the route.
        SELECT
            start_vertices.vertex_id AS start_vertex,
            end_vertices.vertex_id AS end_vertex,
            seq,
            path_seq,
            node,
            edge,
            pt.cost,
            agg_cost,
            ST_AsText(geom) AS geom
        FROM pgr_dijkstraVia(
            query.txt,
            ARRAY[start_vertices.vertex_id] || via.id_arr || ARRAY[end_vertices.vertex_id],
            true, -- directed
            strict:=true,
            U_turn_on_edge:=true
        ) AS pt
        INNER JOIN routing.dr_linkki_k link ON pt.edge = link.gid
    ) AS paths
),
shortest_path_link_counts AS (
    SELECT start_vertex, end_vertex, count(seq) AS link_count
    FROM shortest_path_alternatives
    GROUP BY start_vertex, end_vertex
),
shortest_path_result AS (
    -- Select the longest path alternative.
    SELECT spa.seq, spa.path_seq, spa.node, spa.edge, spa.cost, spa.agg_cost, spa.geom
    FROM (
        SELECT start_vertex, end_vertex
        FROM shortest_path_link_counts
        ORDER BY link_count DESC
        LIMIT 1
    ) t
    INNER JOIN shortest_path_alternatives spa ON spa.start_vertex = t.start_vertex AND spa.end_vertex = t.end_vertex
    ORDER BY seq
),
compound_line AS (
    SELECT ST_LineMerge(ST_Collect(ST_SetSRID(geom, 3067))) AS geom
    FROM shortest_path_result
)
-- SELECT * FROM route_terminal_info;
-- SELECT * FROM via_vertices;
-- SELECT * FROM edge_query;
-- SELECT * FROM shortest_path_result;
SELECT ST_AsGeoJSON(ST_Transform(geom, 4326)) AS geojson FROM compound_line;

-- GeoJSON result:
--  {"type":"MultiLineString","coordinates":[[[24.831412289,60.302887581],[24.830854653,60.303034632],[24.830362214,60.303149431],[24.830068478,60.303234266],[24.829921835,60.303286249],[24.82981675,60.30332841],[24.829921835,60.303286249],[24.830068478,60.303234266],[24.830362214,60.303149431],[24.830854653,60.303034632],[24.831412289,60.302887581]],[[24.834406933,60.302329256],[24.834094203,60.302322335],[24.833369536,60.302425454],[24.832460204,60.302634868],[24.832184682,60.30270285],[24.831754769,60.302804841],[24.831412289,60.302887581]],[[24.834406933,60.302329256],[24.834094203,60.302322335],[24.833369536,60.302425454],[24.832460204,60.302634868],[24.832184682,60.30270285],[24.831754769,60.302804841],[24.831412289,60.302887581]],[[24.835816127,60.302345949],[24.835468723,60.302344943],[24.835005479,60.302341454],[24.834638634,60.302334182],[24.834406933,60.302329256]],[[24.835816127,60.302345949],[24.835468723,60.302344943],[24.835005479,60.302341454],[24.834638634,60.302334182],[24.834406933,60.302329256]],[[24.836348863,60.302340866],[24.835816127,60.302345949]],[[24.836348863,60.302340866],[24.835816127,60.302345949]],[[24.841616742,60.301950592],[24.841332802,60.301941066],[24.840731207,60.301881924],[24.840206703,60.301813973],[24.83980513,60.301792991],[24.839458921,60.301778927],[24.838896285,60.30177098],[24.83843947,60.301796324],[24.83804708,60.301870041],[24.837217102,60.30212145],[24.83635841,60.302339656],[24.836348863,60.302340866]],[[24.841616742,60.301950592],[24.841332802,60.301941066],[24.840731207,60.301881924],[24.840206703,60.301813973],[24.83980513,60.301792991],[24.839458921,60.301778927],[24.838896285,60.30177098],[24.83843947,60.301796324],[24.83804708,60.301870041],[24.837217102,60.30212145],[24.83635841,60.302339656],[24.836348863,60.302340866]],[[24.841880257,60.301954478],[24.841616742,60.301950592]],[[24.841880257,60.301954478],[24.841616742,60.301950592]],[[24.841880257,60.301954478],[24.841925531,60.301956848]],[[24.841880257,60.301954478],[24.841925531,60.301956848]],[[24.841925531,60.301956848],[24.84202501,60.301962048],[24.842356108,60.301978033]],[[24.841925531,60.301956848],[24.84202501,60.301962048],[24.842356108,60.301978033]],[[24.842356108,60.301978033],[24.84248234,60.301991176],[24.842513733,60.30199545]],[[24.842356108,60.301978033],[24.84248234,60.301991176],[24.842513733,60.30199545]],[[24.842513733,60.30199545],[24.842870741,60.302070346],[24.843302093,60.302209125],[24.843714717,60.302347599],[24.843963201,60.302416752]],[[24.842513733,60.30199545],[24.842870741,60.302070346],[24.843302093,60.302209125],[24.843714717,60.302347599],[24.843963201,60.302416752]],[[24.843963201,60.302416752],[24.844472923,60.302504093],[24.845076429,60.302587805],[24.845293123,60.302602134]],[[24.843963201,60.302416752],[24.844472923,60.302504093],[24.845076429,60.302587805],[24.845293123,60.302602134]],[[24.845293123,60.302602134],[24.84552033,60.302610202]],[[24.845293123,60.302602134],[24.84552033,60.302610202]],[[24.846446442,60.302550684],[24.846169341,60.302583728],[24.845809749,60.302608357],[24.84552033,60.302610202]],[[24.846446442,60.302550684],[24.846169341,60.302583728],[24.845809749,60.302608357],[24.84552033,60.302610202]],[[24.848402449,60.302098485],[24.848002587,60.302193641],[24.847653028,60.302277152],[24.846446442,60.302550684]],[[24.848402449,60.302098485],[24.848002587,60.302193641],[24.847653028,60.302277152],[24.846446442,60.302550684]],[[24.850243032,60.301651818],[24.850168494,60.301555177],[24.849955403,60.301386118],[24.849733198,60.30128194],[24.849393761,60.30117811],[24.84922594,60.301143992],[24.849067093,60.301120402],[24.849004302,60.301182134],[24.848634318,60.301510429],[24.848289002,60.301894776],[24.847878386,60.302476747],[24.847461742,60.303063739],[24.847438114,60.303103722],[24.846985904,60.303987749],[24.84674483,60.304884061],[24.846743008,60.304959041],[24.846739694,60.30512406],[24.847000992,60.305119124],[24.84700661,60.305119017],[24.84771857,60.305109911],[24.848519273,60.3051092],[24.849083697,60.305146992],[24.849379526,60.305288083],[24.849461118,60.305367539],[24.849664853,60.305692233],[24.850276705,60.306615214],[24.850387605,60.306790623],[24.850780877,60.307412579],[24.85083592,60.307494524],[24.851242394,60.308099582],[24.85147645,60.308463951],[24.851522594,60.308532054],[24.851590623,60.308626378],[24.85198435,60.309066757],[24.852018259,60.309099829],[24.852596095,60.309606981],[24.853288932,60.310146644],[24.853682936,60.310463671],[24.854295947,60.310950356],[24.854375531,60.311138656],[24.854128672,60.311257814],[24.853622852,60.311400166],[24.853516212,60.311425569],[24.853277315,60.311482375],[24.853050502,60.311544297],[24.853245818,60.311681429],[24.85324875,60.311683928],[24.853376103,60.311797561],[24.853586053,60.311960599],[24.85392691,60.312230653],[24.854213859,60.312481592],[24.854403965,60.312667105],[24.854393853,60.312671657],[24.854309924,60.31280506],[24.854331243,60.312887176],[24.854431618,60.312976929],[24.854440215,60.312981397],[24.854759097,60.313052626],[24.854992113,60.313031777],[24.855171238,60.313285456],[24.855776116,60.313766415],[24.856548505,60.314186238],[24.857293518,60.314466492],[24.858295965,60.314730529],[24.860577951,60.315354289],[24.86339825,60.316090901],[24.86424508,60.316319246],[24.864851768,60.316427051],[24.865582898,60.316504337],[24.866237617,60.316549135],[24.866581457,60.316546257],[24.86706205,60.316587484],[24.867421904,60.316606714],[24.867743522,60.316604455],[24.868074255,60.316604579],[24.868320213,60.316612395],[24.868487961,60.316630508],[24.868709257,60.316663581],[24.868769465,60.316719166],[24.869023579,60.316786618],[24.868977636,60.316839728],[24.868892164,60.316992848],[24.868804818,60.317319155],[24.868849471,60.317647589],[24.869075115,60.317950819],[24.869189241,60.318052996],[24.869375505,60.31821976],[24.8695758,60.318436077],[24.869635574,60.318514793],[24.869786418,60.318720805],[24.869807217,60.318755127],[24.869915806,60.318960426],[24.869979973,60.31919689],[24.869998363,60.31949501],[24.869963532,60.31981254],[24.869876849,60.320170978],[24.869828169,60.320293278],[24.869726433,60.320548047],[24.869582711,60.320857643],[24.869421959,60.321154516],[24.869252473,60.32150225],[24.86906113,60.321877387],[24.868992213,60.322056676],[24.868949879,60.322234613],[24.868928533,60.322383695],[24.868929249,60.322527185],[24.868954448,60.322751285],[24.869006766,60.322986141],[24.869063441,60.323232509],[24.869058362,60.323445462],[24.86901549,60.323600235],[24.868900958,60.3238157],[24.868780314,60.323983498],[24.868670478,60.324104692],[24.868509311,60.324285879],[24.868318108,60.324513784],[24.868171237,60.324690098],[24.868009879,60.324864123],[24.867933915,60.324947713],[24.86781822,60.325075314],[24.867692164,60.325219294],[24.867528855,60.325411215],[24.867398223,60.325564759],[24.867247707,60.325733792],[24.867075533,60.325915188],[24.866845779,60.326140946],[24.866612397,60.326365343],[24.866376539,60.326590157],[24.866170575,60.326806218],[24.866001904,60.326977896],[24.865861975,60.327144628],[24.865708797,60.327355571],[24.865572384,60.327565212],[24.865468685,60.327765678],[24.865345606,60.327994943],[24.865271742,60.328129079],[24.865177111,60.328264436],[24.865092286,60.328384151],[24.86497066,60.328516227],[24.864873736,60.328607346],[24.864861692,60.328618398],[24.864687477,60.328762671],[24.864507793,60.32888194],[24.864351513,60.328979031],[24.864116253,60.329104627],[24.863912085,60.329196843],[24.863664659,60.329302331],[24.863448391,60.329396992],[24.863286268,60.329471703],[24.863179886,60.329535849],[24.862992288,60.329526402],[24.862840028,60.329591805],[24.862811158,60.329629119],[24.862635257,60.329587336],[24.862569859,60.32957185],[24.862146179,60.329463891],[24.861641709,60.329309693],[24.861107664,60.329129446],[24.860789932,60.329023124],[24.860335788,60.328869624],[24.859651187,60.328635463],[24.859529243,60.328593906],[24.859155979,60.328466881],[24.85869526,60.328329095],[24.858173,60.328229873],[24.857643328,60.328214206],[24.857261629,60.328232871],[24.857007934,60.328262742],[24.856760586,60.328312942],[24.856212169,60.328500176],[24.855617189,60.328747358],[24.855098802,60.328979721],[24.854565641,60.329200258],[24.854212386,60.329307496],[24.853758154,60.329417773],[24.853245998,60.329521267],[24.852748101,60.329617497],[24.852707735,60.329546184],[24.852582494,60.329356122],[24.852463105,60.329206582],[24.852314763,60.329052461],[24.852132697,60.32889855],[24.851769994,60.328643204],[24.851304352,60.328314561],[24.850824136,60.327981235],[24.850500246,60.327737569],[24.850289606,60.327593388],[24.850039371,60.327406502],[24.849841534,60.327200209],[24.849741499,60.327036815],[24.84973691,60.327028648],[24.849715835,60.326991059],[24.849668205,60.326824354],[24.849678634,60.326485505],[24.849681387,60.326406759],[24.849705251,60.326213357],[24.849713366,60.325768698],[24.849719723,60.325680049],[24.849762444,60.325451923],[24.849739904,60.325139531],[24.849715477,60.324951914],[24.849689406,60.3248631],[24.849668381,60.32477355],[24.849620867,60.324632114],[24.849383052,60.324366422],[24.849219853,60.324237152],[24.849097981,60.324141282],[24.848558033,60.323833414],[24.848159469,60.32367891],[24.847726555,60.323541122],[24.847344023,60.323455715],[24.846880828,60.323378197],[24.846019845,60.323286974],[24.845279203,60.323202017],[24.84466822,60.323023769],[24.844106653,60.32282381],[24.843977243,60.32280107],[24.843626594,60.322739441],[24.84306989,60.32265671],[24.842910281,60.322646449],[24.842740705,60.322645053],[24.842590417,60.322652449],[24.842536557,60.322656246],[24.842224449,60.322693736],[24.841993909,60.322715116],[24.841823119,60.322716196],[24.841575706,60.322698247],[24.84137735,60.32267328],[24.841200714,60.322622456],[24.841135145,60.322608008],[24.840879315,60.322573834],[24.840981076,60.322407199],[24.841031249,60.322296888],[24.84106309,60.322191848],[24.841142732,60.321944644],[24.841286374,60.321730123],[24.841578039,60.321431849],[24.841774929,60.321187312],[24.841928629,60.320839786],[24.841941787,60.320712337],[24.841946889,60.320607348],[24.841993126,60.320373577],[24.842052762,60.320275356],[24.842099723,60.320209211],[24.84232822,60.319920797],[24.842625272,60.319629696],[24.842753893,60.319517352],[24.843101929,60.319219461],[24.84348286,60.318930142],[24.843510102,60.318908631],[24.843703902,60.318755236],[24.84378183,60.318689288],[24.843819966,60.318654715],[24.843945446,60.318530023],[24.843947564,60.318527847],[24.844094239,60.318400822],[24.844444439,60.318188122],[24.84511097,60.317848056],[24.845162674,60.317822999],[24.845344275,60.317734973],[24.845529959,60.317642665],[24.845956711,60.317446364],[24.846228128,60.317389352],[24.84637847,60.31733292],[24.846706803,60.317177157],[24.846708692,60.317176244],[24.846847477,60.317107193],[24.847174597,60.316944483],[24.847602912,60.316720007],[24.847981829,60.31652102],[24.848112129,60.316451489],[24.84792883,60.316359761],[24.847756282,60.316287634],[24.847074283,60.31597249],[24.846016536,60.315490384],[24.845002055,60.315044343],[24.844996724,60.315041993],[24.844848971,60.314975752],[24.84477129,60.314933184],[24.844788887,60.314864002],[24.844711501,60.314791411],[24.844889538,60.314692388],[24.84510215,60.314585779],[24.845244279,60.314514781],[24.845589225,60.314310166],[24.845687966,60.314254848]],[[24.8493523,60.301871906],[24.849011833,60.30195599],[24.848402449,60.302098485]],[[24.8493523,60.301871906],[24.849011833,60.30195599],[24.848402449,60.302098485]],[[24.850243032,60.301651818],[24.850196718,60.301663338],[24.8493523,60.301871906]],[[24.850243032,60.301651818],[24.850196718,60.301663338],[24.8493523,60.301871906]],[[24.853114927,60.27697085],[24.853058275,60.276849287],[24.853016768,60.276753262],[24.853163592,60.276736953],[24.85348168,60.276690718],[24.853884058,60.276645162],[24.85412572,60.276621726],[24.854174769,60.276734615],[24.854182661,60.276739773],[24.854273844,60.277016466],[24.854411203,60.277432032],[24.854442669,60.277525954],[24.854485783,60.27765743],[24.854502116,60.277701589],[24.854505773,60.277711475],[24.854729814,60.278585018],[24.854752966,60.278675294],[24.854801272,60.279014699],[24.854790229,60.279255061],[24.854713948,60.279629827],[24.854589658,60.279947752],[24.854456774,60.280181483],[24.854318314,60.280356732],[24.8543058,60.28037215],[24.854220117,60.280478416],[24.853965111,60.280794731],[24.853599774,60.281202182],[24.853251336,60.281495473],[24.852537286,60.282128483],[24.852071872,60.282552087],[24.851997442,60.282614844],[24.851906334,60.2826845],[24.851770933,60.282854658],[24.85158125,60.283079851],[24.85151468,60.283162847],[24.851489795,60.283238289],[24.851482983,60.283245607],[24.851001047,60.283739674],[24.850929599,60.28381536],[24.850639474,60.284100274],[24.850360237,60.284370274],[24.850062881,60.284654145],[24.849822943,60.284891106],[24.849684169,60.285050896],[24.849819112,60.28508221],[24.849925836,60.285111854],[24.850230168,60.285191027],[24.850577738,60.285301051],[24.851020497,60.285479819],[24.851530697,60.285667796],[24.851967706,60.285809991],[24.851916106,60.285819998],[24.851794031,60.285843658],[24.851736894,60.28588592],[24.851693904,60.285917713],[24.851415767,60.286131424],[24.850940416,60.2864986],[24.850422278,60.286905008],[24.850015953,60.287204532],[24.849858051,60.287332853],[24.849647167,60.287482485],[24.849349703,60.287711831],[24.849030662,60.287934118],[24.848524627,60.288168052],[24.847772772,60.288499247],[24.847157617,60.288773956],[24.846572558,60.288971374],[24.846216372,60.289075207],[24.846041002,60.289132615],[24.845903943,60.289180261],[24.845398193,60.289361122],[24.844965628,60.289574345],[24.84466458,60.289760599],[24.844503997,60.289858494],[24.844371622,60.28995116],[24.844298471,60.290115172],[24.844146503,60.290248973],[24.843854114,60.290563999],[24.843700373,60.290746902],[24.843448192,60.291070529],[24.843179645,60.291449138],[24.842801308,60.291984579],[24.842561546,60.292300699],[24.842540344,60.292335763],[24.84247757,60.292434354],[24.842367465,60.292607268],[24.842308302,60.292693343],[24.842019666,60.293030145],[24.841743984,60.293389127],[24.841601765,60.293563215],[24.841520702,60.293769475],[24.8415405,60.293980714],[24.841635073,60.294183127],[24.841787258,60.294390032],[24.841975388,60.294564467],[24.842182652,60.294684233],[24.842705455,60.294793055],[24.843546392,60.294892794],[24.843690805,60.29491356],[24.84413237,60.294978626],[24.844444844,60.295029605],[24.844583167,60.295045044],[24.845520526,60.295153404],[24.846228674,60.29519866],[24.846401238,60.295202527],[24.847286475,60.295218403],[24.848082907,60.295190349],[24.84907498,60.295115401],[24.849678535,60.295074747],[24.850193782,60.295041743],[24.851019364,60.295035386],[24.851587627,60.29507385],[24.851970533,60.295088306],[24.852753056,60.295194326],[24.853507081,60.295350028],[24.854043922,60.295483921],[24.85450641,60.295616961],[24.855370484,60.295866208],[24.856401872,60.29617876],[24.856793498,60.296278313],[24.856859145,60.296296115],[24.857084307,60.296357169],[24.857315258,60.296420742],[24.857266461,60.296475303],[24.857281016,60.296529394],[24.85732673,60.296567523],[24.857227,60.296709538],[24.857032876,60.296866476],[24.856675991,60.297115036],[24.85641239,60.297273843],[24.856341617,60.297363806],[24.85651099,60.297476533],[24.856537782,60.297494372],[24.856697865,60.297624348],[24.856891619,60.297795079],[24.857052879,60.297955755],[24.857198701,60.298100707],[24.857623354,60.298452484],[24.858002913,60.29873518],[24.858117759,60.298837837],[24.858193428,60.298913034],[24.858461095,60.299222271],[24.858721801,60.299533696],[24.858859033,60.299661054],[24.858960412,60.299752203],[24.859295718,60.300065745],[24.859308885,60.300079439],[24.859550322,60.300374671],[24.859312107,60.300436285],[24.858941201,60.30054834],[24.85853695,60.300661008],[24.858522406,60.300665031],[24.858118998,60.300779435],[24.857855107,60.300855785],[24.857652421,60.300928091],[24.857484787,60.301028942],[24.857277694,60.301232629],[24.857150124,60.301353195],[24.85686233,60.301639894],[24.856415238,60.301817136],[24.856039387,60.301917805],[24.855901853,60.3019467],[24.855383102,60.302009213],[24.854745009,60.301956183],[24.853922536,60.301765163],[24.853084209,60.301561845],[24.852551996,60.301472091],[24.852368886,60.301449685],[24.852333623,60.301445908],[24.851693963,60.301414485],[24.850889802,60.301508904],[24.850510109,60.30158546],[24.850402817,60.301610769],[24.850243032,60.301651818]]]}
